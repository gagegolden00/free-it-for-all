<div class="bg-primary-600 dark:bg-primary-800 p-2 sm:p-3 shadow-md flex flex-row items-center h-16">
  <h1 class="text-lg sm:text-xl font-medium text-white">Daily Tech Schedule</h1>
  <div class="ml-auto">
    <% if current_user.admin? %>
      <%= render partial: "shared/assign_tech_modal" %>
    <% end %>
  </div>
</div>
<% if @user_service_job_errors.present? %>
  <div
    id="alert-user-service-job-errors"
    data-controller="alert-component"
    class="flex items-center justify-center w-full p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400"
    role="alert"
  >
    <svg class="flex-shrink-0 inline w-4 h-4 mr-3 mt-[2px]" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
      <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
    </svg>
    <div class="w-full">
      <span class="font-medium">
        <%= I18n.t("errors.messages.not_saved",
          count: @user_service_job_errors.count,
          resource: 'User Service Job')
        %>
      </span>
      <ul class="mt-1.5 ml-4 list-disc list-inside">
        <% @user_service_job_errors.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
    <button type="button" class="-mx-1.5 -my-1.5 bg-red-50 text-red-500 rounded-lg focus:ring-2 focus:ring-red-400 p-1.5 hover:bg-red-200 inline-flex items-center justify-center h-8 w-8" data-dismiss-target="#alert-user-service-job-errors" aria-label="Close">
      <span class="sr-only">Dismiss</span>
      <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
      </svg>
    </button>
  </div>
<% end %>
<div class="p-2 md:p-4">
  <div class="flex flex-row">
    <% previous_day = (Date.parse(@selected_date) - 1).strftime('%Y-%m-%d') %>
    <% next_day = (Date.parse(@selected_date) + 1).strftime('%Y-%m-%d') %>
    <%= link_to schedule_path(selected_date: previous_day),  class: 'flex items-center' do %>
      <svg xmlns="http://www.w3.org/2000/svg" height="22" width="14" viewBox="0 0 256 512"><!--!Font Awesome Pro 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2024 Fonticons, Inc.--><path fill="#7b7f7e" d="M54.6 256L144 166.6l0 178.7L54.6 256zM9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l128 128c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6l0-256c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-128 128z"/></svg>
    <% end %>
    <p class=" mx-1 text-gray-600 dark:text-gray-200 flex items-center"><%= content_tag(:span, Date.parse(@selected_date).strftime('%B %d, %Y'), class: "underline") %></p>
    <%= link_to schedule_path(selected_date: next_day), class: 'flex items-center' do %>
      <svg xmlns="http://www.w3.org/2000/svg" height="22" width="14" viewBox="0 0 256 512"><!--!Font Awesome Pro 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2024 Fonticons, Inc.--><path fill="#7b7f7e" d="M201.4 256L112 166.6l0 178.7L201.4 256zm45.3-22.6c12.5 12.5 12.5 32.8 0 45.3l-128 128c-9.2 9.2-22.9 11.9-34.9 6.9s-19.8-16.6-19.8-29.6l0-256c0-12.9 7.8-24.6 19.8-29.6s25.7-2.2 34.9 6.9l128 128z"/></svg>
    <% end %>
    <div class="ml-auto">
      <%= form_tag("/schedule", method: "get") do %>
        <%= date_field_tag :selected_date, @selected_date, onchange: "this.form.submit()", class: "w-36 h-10 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block ps-2 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" %>
      <% end %>
    </div>
  </div>
</div>
<div class="overflow-x-scroll bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded mx-2 md:mx-4" style="display:grid; grid-template-columns: 160px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px;">
  <div class="text-xs font-semibold bg-gray-300  dark:bg-gray-500 border-r border-gray-300 dark:border-gray-500">&nbsp;</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:2; grid-column-end:6">12am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:6; grid-column-end:10">1am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:10; grid-column-end:14">2am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:14; grid-column-end:18">3am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:18; grid-column-end:22">4am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:22; grid-column-end:26">5am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:26; grid-column-end:30">6am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:30; grid-column-end:34">7am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:34; grid-column-end:38">8am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:38; grid-column-end:42">9am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:42; grid-column-end:46">10am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:46; grid-column-end:50">11am</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:50; grid-column-end:54">12pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:54; grid-column-end:58">1pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:58; grid-column-end:62">2pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:62; grid-column-end:66">3pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:66; grid-column-end:70">4pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:70; grid-column-end:74">5pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:74; grid-column-end:78">6pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:78; grid-column-end:82">7pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:82; grid-column-end:86">8pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:86; grid-column-end:90">9pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:90; grid-column-end:94">10pm</div>
  <div class="text-xs pl-1 font-semibold border-l border-b bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600" style="grid-column-start:94; grid-column-end:98">11pm</div>
  <% current_name = nil %>
  <% total_colors = ScheduleHelper.color_list.length - 1 %>
  <% color_index  = 0 %>
  <% @daily_tech_schedule_data.each do |data| %>
    <% if current_name != data.name %>
      <div class="p-2 text-sm font font-semibold bg-gray-100 dark:bg-gray-900 border-r border-t border-gray-300 dark:border-gray-600" style="grid-column: 1"><%= data.name %></div>
      <% current_name = data.name %>
      <% color_index = (color_index == total_colors) ? 0 : color_index + 1 %>
    <% end %>
    <% unless ScheduleHelper.get_grid_col_value(data.start_time).nil? %>
      <div class="<%= ScheduleHelper.color_list[color_index]  %> text-white italic p-1 m-1 rounded-sm shadow-md text-sm whitespace-nowrap text-ellipsis overflow-hidden"
          style="grid-column-start: <%= ScheduleHelper.get_grid_col_value(data.start_time) %>; grid-column-end: <%= ScheduleHelper.get_grid_col_value(data.end_time) %>">
        <%= link_to "#{data.customer_name}", schedule_path(user_service_job_id: data.user_service_job_id, display_modal: "true", user_id: data.user_id), data: {turbo_stream: true}, title: "#{data.customer_name}"%>
      </div>
    <% end %>
  <% end %>
  <turbo_frame id="scheduleDetials">
  </turbo_frame>
</div>
